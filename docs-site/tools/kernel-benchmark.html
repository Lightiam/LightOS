<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPU Kernel Benchmark - LightOS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: #a0a0a0;
            font-size: 1.1em;
        }

        .controls {
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .control-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #b0b0b0;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        select, button {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        select:hover, button:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            font-weight: 600;
            margin-top: 20px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .metric-label {
            color: #a0a0a0;
            font-size: 0.9em;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .metric-unit {
            font-size: 0.4em;
            color: #a0a0a0;
            margin-left: 5px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .chart-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #e0e0e0;
        }

        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .bar-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .bar-label {
            min-width: 150px;
            color: #b0b0b0;
            font-size: 0.9em;
        }

        .bar-container {
            flex: 1;
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
        }

        .bar-value {
            color: white;
            font-weight: 600;
            font-size: 0.85em;
        }

        .table-container {
            background: rgba(255, 255, 255, 0.05);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        th {
            background: rgba(255, 255, 255, 0.05);
            color: #b0b0b0;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        td {
            color: #e0e0e0;
        }

        .status-pass {
            color: #4caf50;
            font-weight: 600;
        }

        .status-fail {
            color: #f44336;
            font-weight: 600;
        }

        .suite-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
            background: rgba(102, 126, 234, 0.2);
            color: #667eea;
        }

        .difficulty-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 0.75em;
            font-weight: 600;
        }

        .diff-1 { background: rgba(76, 175, 80, 0.2); color: #4caf50; }
        .diff-2 { background: rgba(255, 193, 7, 0.2); color: #ffc107; }
        .diff-3 { background: rgba(255, 152, 0, 0.2); color: #ff9800; }
        .diff-4 { background: rgba(255, 87, 34, 0.2); color: #ff5722; }
        .diff-5 { background: rgba(244, 67, 54, 0.2); color: #f44336; }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .results {
                grid-template-columns: 1fr;
            }

            .metric-value {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸ”¬ GPU Kernel Benchmark</h1>
            <p class="subtitle">Comprehensive kernel evaluation across DSLs and hardware backends</p>
        </header>

        <div class="controls">
            <div class="control-group">
                <label for="benchmarkSuite">Benchmark Suite</label>
                <select id="benchmarkSuite">
                    <option value="kernelbench">KernelBench (250 PyTorch tasks)</option>
                    <option value="robust_kbench">Robust KernelBench (Anti-reward hacking)</option>
                    <option value="tritonbench">TritonBench (GitHub ops + PyTorch)</option>
                    <option value="tritongym">TritonGym (Agentic workflows)</option>
                    <option value="flashinfer">FlashInfer-Bench (Real serving traces)</option>
                    <option value="backend">BackendBench (Meta shipping tests)</option>
                    <option value="multikern">MultiKernelBench (285 cross-platform tasks)</option>
                    <option value="rocm_triton">AMD ROCm Triton</option>
                    <option value="compute_eval">ComputeEval (Correctness-first)</option>
                    <option value="metr_level5">METR Level 5 (Frontier difficulty)</option>
                </select>
            </div>

            <div class="control-group">
                <label for="dslType">DSL Type</label>
                <select id="dslType">
                    <option value="triton">Triton</option>
                    <option value="cuda">CUDA</option>
                    <option value="cutedsl">CuteDSL</option>
                    <option value="rocm">ROCm</option>
                    <option value="metal">Metal</option>
                    <option value="sycl">SYCL</option>
                </select>
            </div>

            <div class="control-group">
                <label for="hardwareBackend">Hardware Backend</label>
                <select id="hardwareBackend">
                    <option value="nvidia">NVIDIA GPU</option>
                    <option value="amd">AMD GPU</option>
                    <option value="intel">Intel GPU</option>
                    <option value="apple">Apple GPU</option>
                    <option value="tpu">Google TPU</option>
                    <option value="npu">Neural Processing Unit</option>
                </select>
            </div>

            <button onclick="runBenchmark()">Run Benchmark</button>
        </div>

        <div class="results">
            <div class="metric-card">
                <div class="metric-label">Total Kernels</div>
                <div class="metric-value" id="totalKernels">0</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Correctness Rate</div>
                <div class="metric-value" id="correctnessRate">0<span class="metric-unit">%</span></div>
            </div>
            <div class="metric-card">
                <div class="metric-label">fast_p (â‰¥1.10x)</div>
                <div class="metric-value" id="fastP">0<span class="metric-unit">%</span></div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Avg Speedup</div>
                <div class="metric-value" id="avgSpeedup">0<span class="metric-unit">x</span></div>
            </div>
        </div>

        <div class="chart-container">
            <div class="chart-title">fast_p Metrics (Correct AND Fast)</div>
            <div class="bar-chart" id="fastPChart"></div>
        </div>

        <div class="chart-container">
            <div class="chart-title">Performance by Category</div>
            <div class="bar-chart" id="categoryChart"></div>
        </div>

        <div class="table-container">
            <div class="chart-title">Detailed Results</div>
            <table>
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Suite</th>
                        <th>Category</th>
                        <th>Difficulty</th>
                        <th>Correctness</th>
                        <th>Latency (ms)</th>
                        <th>Throughput (GOPS)</th>
                        <th>Speedup</th>
                    </tr>
                </thead>
                <tbody id="resultsTable"></tbody>
            </table>
        </div>
    </div>

    <script>
        // Mock benchmark data generator
        function generateBenchmarkResults(suite, dsl, backend) {
            const suites = {
                'kernelbench': { tasks: 25, name: 'KernelBench' },
                'robust_kbench': { tasks: 25, name: 'Robust-K' },
                'tritonbench': { tasks: 15, name: 'TritonBench' },
                'tritongym': { tasks: 10, name: 'TritonGym' },
                'flashinfer': { tasks: 8, name: 'FlashInfer' },
                'backend': { tasks: 20, name: 'BackendBench' },
                'multikern': { tasks: 30, name: 'MultiKernelBench' },
                'rocm_triton': { tasks: 12, name: 'ROCm-Triton' },
                'compute_eval': { tasks: 18, name: 'ComputeEval' },
                'metr_level5': { tasks: 5, name: 'METR-L5' }
            };

            const categories = ['MatMul', 'Conv', 'Attention', 'Reduction', 'FlashAttn', 'LayerNorm', 'Fused Ops'];
            const difficulties = [1, 2, 3, 4, 5];

            const suiteInfo = suites[suite];
            const results = [];

            for (let i = 0; i < suiteInfo.tasks; i++) {
                const correctness = Math.random() > 0.15; // 85% pass rate
                const latency = 0.05 + Math.random() * 2; // 0.05-2.05 ms
                const throughput = (Math.random() * 500 + 50); // 50-550 GOPS
                const speedup = correctness ? 0.8 + Math.random() * 2.5 : 0; // 0.8-3.3x if correct

                results.push({
                    task: `Task ${i + 1}`,
                    suite: suiteInfo.name,
                    category: categories[Math.floor(Math.random() * categories.length)],
                    difficulty: difficulties[Math.floor(Math.random() * difficulties.length)],
                    correctness,
                    latency,
                    throughput,
                    speedup
                });
            }

            return results;
        }

        function calculateMetrics(results) {
            const total = results.length;
            const correct = results.filter(r => r.correctness).length;
            const correctnessRate = (correct / total) * 100;

            // Calculate fast_p at different thresholds
            const thresholds = [1.0, 1.05, 1.10, 1.20, 1.50, 2.0];
            const fastP = {};

            thresholds.forEach(t => {
                const fast = results.filter(r => r.correctness && r.speedup >= t).length;
                fastP[t] = (fast / total) * 100;
            });

            const avgSpeedup = results
                .filter(r => r.correctness)
                .reduce((sum, r) => sum + r.speedup, 0) / correct;

            // Performance by category
            const byCategory = {};
            results.forEach(r => {
                if (!byCategory[r.category]) {
                    byCategory[r.category] = { total: 0, fast: 0 };
                }
                byCategory[r.category].total++;
                if (r.correctness && r.speedup >= 1.1) {
                    byCategory[r.category].fast++;
                }
            });

            return { total, correctnessRate, fastP, avgSpeedup, byCategory };
        }

        function updateUI(results, metrics) {
            // Update metric cards
            document.getElementById('totalKernels').textContent = metrics.total;
            document.getElementById('correctnessRate').innerHTML =
                `${metrics.correctnessRate.toFixed(1)}<span class="metric-unit">%</span>`;
            document.getElementById('fastP').innerHTML =
                `${metrics.fastP[1.10].toFixed(1)}<span class="metric-unit">%</span>`;
            document.getElementById('avgSpeedup').innerHTML =
                `${metrics.avgSpeedup.toFixed(2)}<span class="metric-unit">x</span>`;

            // Update fast_p chart
            const fastPChart = document.getElementById('fastPChart');
            fastPChart.innerHTML = '';

            [
                { label: 'fast_100 (â‰¥1.00x)', value: metrics.fastP[1.0] },
                { label: 'fast_105 (â‰¥1.05x)', value: metrics.fastP[1.05] },
                { label: 'fast_110 (â‰¥1.10x)', value: metrics.fastP[1.10] },
                { label: 'fast_120 (â‰¥1.20x)', value: metrics.fastP[1.20] },
                { label: 'fast_150 (â‰¥1.50x)', value: metrics.fastP[1.50] },
                { label: 'fast_200 (â‰¥2.00x)', value: metrics.fastP[2.0] },
            ].forEach(item => {
                const barItem = document.createElement('div');
                barItem.className = 'bar-item';
                barItem.innerHTML = `
                    <div class="bar-label">${item.label}</div>
                    <div class="bar-container">
                        <div class="bar-fill" style="width: ${item.value}%">
                            <span class="bar-value">${item.value.toFixed(1)}%</span>
                        </div>
                    </div>
                `;
                fastPChart.appendChild(barItem);
            });

            // Update category chart
            const categoryChart = document.getElementById('categoryChart');
            categoryChart.innerHTML = '';

            Object.entries(metrics.byCategory).forEach(([category, data]) => {
                const percentage = (data.fast / data.total) * 100;
                const barItem = document.createElement('div');
                barItem.className = 'bar-item';
                barItem.innerHTML = `
                    <div class="bar-label">${category}</div>
                    <div class="bar-container">
                        <div class="bar-fill" style="width: ${percentage}%">
                            <span class="bar-value">${percentage.toFixed(1)}%</span>
                        </div>
                    </div>
                `;
                categoryChart.appendChild(barItem);
            });

            // Update results table
            const resultsTable = document.getElementById('resultsTable');
            resultsTable.innerHTML = '';

            results.slice(0, 20).forEach(result => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${result.task}</td>
                    <td><span class="suite-badge">${result.suite}</span></td>
                    <td>${result.category}</td>
                    <td><span class="difficulty-badge diff-${result.difficulty}">L${result.difficulty}</span></td>
                    <td class="${result.correctness ? 'status-pass' : 'status-fail'}">
                        ${result.correctness ? 'âœ“ PASS' : 'âœ— FAIL'}
                    </td>
                    <td>${result.latency.toFixed(3)}</td>
                    <td>${result.throughput.toFixed(1)}</td>
                    <td>${result.speedup > 0 ? result.speedup.toFixed(2) + 'x' : 'N/A'}</td>
                `;
                resultsTable.appendChild(row);
            });
        }

        function runBenchmark() {
            const suite = document.getElementById('benchmarkSuite').value;
            const dsl = document.getElementById('dslType').value;
            const backend = document.getElementById('hardwareBackend').value;

            // Generate mock results
            const results = generateBenchmarkResults(suite, dsl, backend);
            const metrics = calculateMetrics(results);

            // Update UI
            updateUI(results, metrics);
        }

        // Run initial benchmark on load
        window.addEventListener('load', () => {
            runBenchmark();
        });
    </script>
</body>
</html>
